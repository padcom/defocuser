<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Introduction | Defocuser</title>
    <meta name="description" content="Utility for detecting clicks outside of an element">
    
    
    <link rel="preload" href="/defocuser/assets/css/3.styles.b421779c.css" as="style"><link rel="preload" href="/defocuser/assets/js/app.cab3adce.js" as="script"><link rel="preload" href="/defocuser/assets/js/1.862be92c.js" as="script"><link rel="prefetch" href="/defocuser/assets/js/0.bd32c31d.js"><link rel="prefetch" href="/defocuser/assets/js/2.fe08fa3d.js">
    <link rel="stylesheet" href="/defocuser/assets/css/3.styles.b421779c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/defocuser/" class="home-link router-link-active"><!----><span class="site-name">
      Defocuser
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/defocuser/guide/" class="nav-link router-link-exact-active router-link-active">Guide</a></div><div class="nav-item"><a href="/defocuser/api/" class="nav-link">API</a></div><a href="https://github.com/padcom/defocuser" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/defocuser/guide/" class="nav-link router-link-exact-active router-link-active">Guide</a></div><div class="nav-item"><a href="/defocuser/api/" class="nav-link">API</a></div><a href="https://github.com/padcom/defocuser" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Introduction</span><!----></p><ul class="sidebar-group-items"><li><a href="/defocuser/guide/#usage" class="sidebar-link">Usage</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/defocuser/guide/#special-case" class="sidebar-link">Special case</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/defocuser/guide/#remarks" class="sidebar-link">Remarks</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="introduction"><a href="#introduction" aria-hidden="true" class="header-anchor">#</a> Introduction</h1><p>It has been way too many times when I implemented (with greater or lesser success) automated way
for closing dropdowns when clicking outside of them or by pressing the Escape key. This utility
is a way for me to stop repeating myself and have it working always the way it should.</p><h2 id="usage"><a href="#usage" aria-hidden="true" class="header-anchor">#</a> Usage</h2><p>Let's assume you have an element on the page that acts as a popup, modal or dropdown of some kind.
Those elements usually go away once the user clicks outside of them or presses the <code>Escape</code> key.</p><div class="language- extra-class"><pre class="language-text"><code>&lt;div id=&quot;popup&quot;&gt;
  Lorem ipsum...
&lt;/div&gt;

</code></pre></div><p>That is where <code>Defocuser</code> comes in. First you need to import it as a dependency. That can be done
either directly using a <code>&lt;script&gt;</code> tag:</p><div class="language- extra-class"><pre class="language-text"><code>&lt;script src=&quot;https://unpkg.com/defocuser&quot;&gt;&lt;/script&gt;
</code></pre></div><p>or (if you're using some kind of build system like Webpack or Rollup) as an NPM dependency:</p><div class="language- extra-class"><pre class="language-text"><code>npm install --save-dev defocuser
</code></pre></div><p>and then import it in your source like this:</p><div class="language- extra-class"><pre class="language-text"><code>import Defocuser from 'defocuser'
</code></pre></div><p>Once you have decided which way you want to include it create an instance of <code>Defocuser</code> and add the root element of your dialog/popup/dropdown,
select the phase the callback should be called and provide the actual callback itself:</p><div class="language- extra-class"><pre class="language-text"><code>const popup = document.querySelector('#popup')
const defocuser = new Defocuser()
defocuser.addElement(popup, 'bubbling', () =&gt; { popup.remove() })
</code></pre></div><p>Please note the callback calls <code>remove()</code> on the popup effectively removing it from the DOM tree.
Defocuser interally uses <code>MutationObserver</code> and once it detects that the added node is removed
it is also removed from the internal state of defocuser.</p><p>It works this way because <code>Defocuser</code> is ready for stacked elements!
This means that if you have a modal that has a set of dropdowns that maybe have some other popups
<code>Defocuser</code> keeps tracl of all those elements and closes only the recent one! Just like you would expect!</p><h2 id="special-case"><a href="#special-case" aria-hidden="true" class="header-anchor">#</a> Special case</h2><p>Sometimes there is more than one element that you would like to treat as part of your dialog.
Let's examine the following case:</p><div class="language- extra-class"><pre class="language-text"><code>&lt;span id=&quot;input&quot;&gt;My input&lt;/span&gt;
&lt;ul id=&quot;options&quot;&gt;
  &lt;li&gt;Option 1&lt;/li&gt;
  &lt;li&gt;Option 2&lt;/li&gt;
  &lt;li&gt;Option 3&lt;/li&gt;
&lt;/ul&gt;
</code></pre></div><p>This if structure is dynamic and the element that actiones the dropdown is static you can set it to be
also taken into account when tracking user interactions:</p><div class="language- extra-class"><pre class="language-text"><code>const dropdown = document.querySelector('#options')
const secondary = document.querySelector('#input')
defocuser.setSecondaryElement(dropdown, secondary)
</code></pre></div><p>This way when <code>defocuser</code> checks if the click happened outside of your dropdown it will also take the <code>secondary</code> element into account
as though it would be inside of your dropdown.</p><p>It is especially usefull when your <code>input</code> steers some part of your dropdown (like selecting start and end date of a period of time).</p><h2 id="remarks"><a href="#remarks" aria-hidden="true" class="header-anchor">#</a> Remarks</h2><p>The <code>Defocuser</code> uses <code>MutationObserver</code> to detect when the element has been removed from
the DOM. So you should physically remove the element to clean things up.</p></div><div class="page-edit"><!----><!----></div><!----></div></div></div>
    <script src="/defocuser/assets/js/1.862be92c.js" defer></script><script src="/defocuser/assets/js/app.cab3adce.js" defer></script>
  </body>
</html>
